const o=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const M=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native,window.enmity.modules.common.React,window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings;const S=window.enmity.modules.common.Users;window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function _(n){window.enmity.plugins.registerPlugin(n)}function p(...n){return window.enmity.modules.getByProps(...n)}window.enmity.modules.common;function g(n){return window.enmity.patcher.create(n)}var A="SplitMessages",G="1.0.0",T="Splits messages over the message length limit into multiple.",L=[{name:"eternal",id:"263689920210534400"}],N={name:A,version:G,description:T,authors:L};const h=p("hasChannel"),y=g("split-messages"),v={...N,onStart(){o._MAX_MESSAGE_LENGTH=o.MAX_MESSAGE_LENGTH,o._MAX_MESSAGE_LENGTH_PREMIUM=o.MAX_MESSAGE_LENGTH_PREMIUM,o.MAX_MESSAGE_LENGTH_PREMIUM=9999999999999,o.MAX_MESSAGE_LENGTH=9999999999999,y.instead(M,"sendMessage",(n,s,t)=>{var r,u;const[l,i]=s;if(!(i!=null&&i.content)||!l)return t.apply(n,s);const d=h.getChannel(l);if(!d)return t.apply(n,s);const E=S.getCurrentUser().premiumType===2?o._MAX_MESSAGE_LENGTH_PREMIUM:o._MAX_MESSAGE_LENGTH;if(((r=i.content)==null?void 0:r.length)<=E)return t.apply(n,s);const e=(u=i.content.match(new RegExp(`.{0,${E}}`,"g")))==null?void 0:u.filter(Boolean);if(!e||e.length===1)return t.apply(n,s);if(d.rateLimitPerUser){t.apply(n,[l,{...i,content:e.shift()}]);for(let m=0,w=e.length;m<w;m++)setTimeout(c=>{const a=[l,{...i,content:c}];t.apply(n,a)},d.rateLimitPerUser*1e3+1e3,e[m])}else for(let m=0,w=e.length;m<w;m++)setTimeout(c=>{const a=[l,{...i,content:c}];t.apply(n,a)},1e3*m*(e>4?2:1),e[m])})},onStop(){o._MAX_MESSAGE_LENGTH&&(o.MAX_MESSAGE_LENGTH=o._MAX_MESSAGE_LENGTH),o._MAX_MESSAGE_LENGTH_PREMIUM&&(o.MAX_MESSAGE_LENGTH_PREMIUM=o._MAX_MESSAGE_LENGTH_PREMIUM),y.unpatchAll()}};_(v);
