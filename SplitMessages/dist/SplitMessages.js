const o=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const r=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native,window.enmity.modules.common.React,window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings;const y=window.enmity.modules.common.Users;window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function M(n){window.enmity.plugins.registerPlugin(n)}function S(...n){return window.enmity.modules.getByProps(...n)}window.enmity.modules.common;function _(n){return window.enmity.patcher.create(n)}var A="SplitMessages",g="1.0.0",p="Splits messages over the message length limit into multiple.",G=[{name:"eternal",id:"263689920210534400"}],L={name:A,version:g,description:p,authors:G};const T=S("hasChannel"),u=_("split-messages"),N={...L,onStart(){o._MAX_MESSAGE_LENGTH=o.MAX_MESSAGE_LENGTH,o._MAX_MESSAGE_LENGTH_PREMIUM=o.MAX_MESSAGE_LENGTH_PREMIUM,o.MAX_MESSAGE_LENGTH_PREMIUM=9999999999999,o.MAX_MESSAGE_LENGTH=9999999999999,u.instead(r,"sendMessage",(n,d,t)=>{const[s,i]=d;if(!(i!=null&&i.content)||!s)return t.apply(n,d);const w=T.getChannel(s);if(!w)return t.apply(n,d);const E=y.getCurrentUser().premiumType===2?o._MAX_MESSAGE_LENGTH_PREMIUM:o._MAX_MESSAGE_LENGTH,e=i.content.match(new RegExp(`.{0,${E}}`,"g"));if(!e||e.length===1)return t.apply(n,d);if(w.rateLimitPerUser){t.apply(n,[s,{...i,content:e.shift()}]);for(let m=0,l=e.length;m<l;m++)setTimeout(c=>{const a=[s,{...i,content:c}];t.apply(n,a)},w.rateLimitPerUser*1e3+1e3,e[m])}else for(let m=0,l=e.length;m<l;m++)setTimeout(c=>{const a=[s,{...i,content:c}];t.apply(n,a)},1e3*m*(e>4?2:1),e[m])})},onStop(){o._MAX_MESSAGE_LENGTH&&(o.MAX_MESSAGE_LENGTH=o._MAX_MESSAGE_LENGTH),o._MAX_MESSAGE_LENGTH_PREMIUM&&(o.MAX_MESSAGE_LENGTH_PREMIUM=o._MAX_MESSAGE_LENGTH_PREMIUM),u.unpatchAll()}};M(N);
